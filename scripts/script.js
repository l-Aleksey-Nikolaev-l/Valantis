const URL = "https://api.valantis.store:41000/";async function checkSession() {    if(!sessionStorage.getItem("X-Auth")) {        console.log("Welcome! Please, enter API password!");        return;    }    let check = await fetch(URL, generateLoginOptions(sessionStorage.getItem("X-Auth")));    if (check.status === 200) {        showComponents(true);        console.log("You logged!");    } else {        showComponents(false)        sessionStorage.removeItem("X-Auth");        console.log("Wrong API password!");    }}function showComponents(state) {    if(!state) {        document.getElementById("dataPanel").style.display = "none";        document.getElementById("logOutButton").style.display = "none";        document.body.innerHTML += `        <section id="loginComponent">            <section id="loginPanel">                <label id="passwordLabel" for="apiPass">API Password</label>                <input id="apiPass" type="text">                <button id="logInButton" type="submit" onclick="logIn()">LogIn</button>            </section>        </section> `;    }    else {        document.getElementById("loginComponent").remove()        document.getElementById("logOutButton").style.display = "initial";        document.getElementById("dataPanel").style.display = "initial";    }}async function logIn() {    let apiPassword = document.getElementById("apiPass").value;    let md5hash = generateMD5HASH(apiPassword);    let loginOptions = generateLoginOptions(md5hash);    let response = await fetch(URL, loginOptions);    if (response.status === 200) {        showComponents(true);        sessionStorage.setItem("X-Auth", md5hash);        console.log(`API password is correct! Code: ${response.status}`)    } else {        alert(`Error, code: ${response.status}`);    }}function generateLoginOptions(MD5) {    let header = { "Content-Type": "application/json", "X-Auth": MD5 };    let request = JSON.stringify({        "action": "get_ids",        "params": {"limit": 0}    });    return { method: "POST", headers: header, body: request };}function generateTimeStamp() {    const currentDate = new Date();    const dateFormat = new Intl.DateTimeFormat("en-CA");    // return dateFormat.format(currentDate).split("-").join("");    return 20240307;}function generateMD5HASH(apiPass) {    let md5hash = CryptoJS.MD5(`${apiPass}_${generateTimeStamp()}`);    return md5hash.toString();}function logOut() {    if(sessionStorage.getItem("X-Auth")) {        sessionStorage.removeItem("X-Auth");        showComponents(false)        console.log("Bye bye! You are logged out!");    }}async function getData() {    let newData = await fetch(URL, generateDataOptions())        .then(response => {            return response.json();        })    let crunchedData = newData.result;    addData(crunchedData);}function addData(data) {    let table = document.querySelector("#dataSection");    table.innerHTML = data.map(value => {        return (            `<tr>                <td>${value["id"]}</td>                <td>${value["product"]}</td>                <td>${value["price"]}</td>                <td>${value["brand"]}</td>            </tr>`);    }).join('');}function generateDataOptions() {    let MD5 = sessionStorage.getItem("X-Auth");    let header = { "Content-Type": "application/json", "X-Auth": MD5 };    let request = JSON.stringify({        "action": "get_items",        "params": {"ids": ["1789ecf3-f81c-4f49-ada2-83804dcc74b0", "711837ec-57f6-4145-b17f-c74c2896bafe", "18e4e3bd-5e60-4348-8c92-4f61c676be1f", "711837ec-57f6-4145-b17f-c74c2896bafe", "6c972a4a-5b91-4a98-9780-3a19a7f41560"]}    });    return { method: "POST", headers: header, body: request };}